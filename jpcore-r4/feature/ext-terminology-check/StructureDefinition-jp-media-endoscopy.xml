<?xml version="1.0" encoding="UTF-8"?>

<StructureDefinition xmlns="http://hl7.org/fhir">
  <id value="jp-media-endoscopy"/>
  <text>
    <status value="extensions"/><div xmlns="http://www.w3.org/1999/xhtml">Placeholder</div>
  </text>
  <url value="http://jpfhir.jp/fhir/core/StructureDefinition/JP_Media_Endoscopy"/>
  <version value="1.1.2"/>
  <name value="JP_Media_Endoscopy"/>
  <title value="JP Core media Endoscopy Profile"/>
  <status value="active"/>
  <date value="2023-06-26"/>
  <publisher value="FHIR Japanese implementation research working group in Japan Association of Medical Informatics (JAMI)"/>
  <contact>
    <name value="FHIR Japanese implementation research working group in Japan Association of Medical Informatics (JAMI)"/>
    <telecom>
      <system value="url"/>
      <value value="http://jpfhir.jp"/>
    </telecom>
    <telecom>
      <system value="email"/>
      <value value="office@hlfhir.jp"/>
    </telecom>
  </contact>
  <description value="このプロファイルはMediaリソースに対して、主に内視鏡検査で取得または使用される画像、映像、音声に関わるデータを送受信するための制約と拡張を定めたものである。"/>
  <jurisdiction>
    <coding>
      <system value="urn:iso:std:iso:3166"/>
      <code value="JP"/>
    </coding>
  </jurisdiction>
  <copyright value="Copyright FHIR Japanese implementation research working group in Japan Association of Medical Informatics (JAMI) 一般社団法人日本医療情報学会NeXEHRS課題研究会FHIR日本実装検討WG"/>
  <fhirVersion value="4.0.1"/>
  <mapping>
    <identity value="workflow"/>
    <uri value="http://hl7.org/fhir/workflow"/>
    <name value="Workflow Pattern"/>
  </mapping>
  <mapping>
    <identity value="rim"/>
    <uri value="http://hl7.org/v3"/>
    <name value="RIM Mapping"/>
  </mapping>
  <mapping>
    <identity value="w5"/>
    <uri value="http://hl7.org/fhir/fivews"/>
    <name value="FiveWs Pattern Mapping"/>
  </mapping>
  <mapping>
    <identity value="dicom"/>
    <uri value="http://nema.org/dicom"/>
    <name value="DICOM Tag Mapping"/>
  </mapping>
  <mapping>
    <identity value="v2"/>
    <uri value="http://hl7.org/v2"/>
    <name value="HL7 v2 Mapping"/>
  </mapping>
  <mapping>
    <identity value="sct-concept"/>
    <uri value="http://snomed.info/conceptdomain"/>
    <name value="SNOMED CT Concept Domain Binding"/>
  </mapping>
  <mapping>
    <identity value="sct-attr"/>
    <uri value="http://snomed.org/attributebinding"/>
    <name value="SNOMED CT Attribute Binding"/>
  </mapping>
  <kind value="resource"/>
  <abstract value="false"/>
  <type value="Media"/>
  <baseDefinition value="http://hl7.org/fhir/StructureDefinition/Media"/>
  <derivation value="constraint"/>
  <snapshot>
    <element id="Media">
      <path value="Media"/>
      <short value="内視鏡検査で取得または使用される画像、映像、音声に関わる情報。"/>
      <definition value="内視鏡検査で取得または使用される画像、映像、音声に関わる情報。"/>
      <min value="0"/>
      <max value="*"/>
      <base>
        <path value="Media"/>
        <min value="0"/>
        <max value="*"/>
      </base>
      <constraint>
        <key value="dom-2"/>
        <severity value="error"/>
        <human value="もしリソースが他のリソースに含まれている場合、そのリソースにはネストされたリソースを含めてはなりません (moshi risōsu ga hoka no risōsu ni fukumarete iru baai, sono risōsu ni wa nesuto sareta risōsu o fukumete wa narimasen)."/>
        <expression value="contained.contained.empty()"/>
        <xpath value="not(parent::f:contained and f:contained)"/>
        <source value="http://hl7.org/fhir/StructureDefinition/DomainResource"/>
      </constraint>
      <constraint>
        <key value="dom-3"/>
        <severity value="error"/>
        <human value="もしリソースが他のリソースに含まれている場合、それはリソースの他の場所から参照されるか、含まれるリソースに参照されるべきです。"/>
        <expression value="contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()"/>
        <xpath value="not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))"/>
        <source value="http://hl7.org/fhir/StructureDefinition/DomainResource"/>
      </constraint>
      <constraint>
        <key value="dom-4"/>
        <severity value="error"/>
        <human value="もしリソースが別のリソースの中に含まれる場合、meta.versionIdまたはmeta.lastUpdatedを持つべきではありません。"/>
        <expression value="contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()"/>
        <xpath value="not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))"/>
        <source value="http://hl7.org/fhir/StructureDefinition/DomainResource"/>
      </constraint>
      <constraint>
        <key value="dom-5"/>
        <severity value="error"/>
        <human value="「もしリソースが他のリソースに含まれている場合、セキュリティラベルを持つべきではありません。」"/>
        <expression value="contained.meta.security.empty()"/>
        <xpath value="not(exists(f:contained/*/f:meta/f:security))"/>
        <source value="http://hl7.org/fhir/StructureDefinition/DomainResource"/>
      </constraint>
      <constraint>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice">
          <valueBoolean value="true"/>
        </extension>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation">
          <valueMarkdown value="When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."/>
        </extension>
        <key value="dom-6"/>
        <severity value="warning"/>
        <human value="「資源は堅牢な管理のために物語を持つべきである。」"/>
        <expression value="text.`div`.exists()"/>
        <xpath value="exists(f:text/h:div)"/>
        <source value="http://hl7.org/fhir/StructureDefinition/DomainResource"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="false"/>
      <mapping>
        <identity value="rim"/>
        <map value="Entity. Role, or Act"/>
      </mapping>
      <mapping>
        <identity value="workflow"/>
        <map value="Event"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value="Act[classCode=&quot;DGIMG&quot;, moodCode=&quot;EVN&quot;]"/>
      </mapping>
    </element>
    <element id="Media.id">
      <path value="Media.id"/>
      <short value="このアーティファクトの論理ID"/>
      <definition value="「リソースのURLで使用される論理ID。一度割り当てられたら、この値は変更されません。」"/>
      <comment value="「リソースにIDがないのは、作成操作を使用してサーバーに送信されているときだけです。」"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Resource.id"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <extension url="http://hl7.org/fhir/StructureDefinition/structuredefinition-fhir-type">
          <valueUrl value="id"/>
        </extension>
        <code value="http://hl7.org/fhirpath/System.String"/>
      </type>
      <isModifier value="false"/>
      <isSummary value="true"/>
    </element>
    <element id="Media.meta">
      <path value="Media.meta"/>
      <short value="「リソースに関するメタデータ」"/>
      <definition value="リソースに関するメタデータ。これはインフラストラクチャによって維持されるコンテンツです。 コンテンツの変更は、リソースのバージョン変更と常に関連しているわけではありません。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Resource.meta"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="Meta"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
    </element>
    <element id="Media.implicitRules">
      <path value="Media.implicitRules"/>
      <short value="このコンテンツが作成されたルールセット"/>
      <definition value="「リソース構築時に遵守された一連のルールを指すものであり、コンテンツを処理する際に理解する必要があります。しばしば、特別なルールを定義する実装ガイドとその他のプロファイルなどを含むものです。」"/>
      <comment value="このルールセットを主張することで、取引先の限られた集団にしか内容を理解させることができず、長期的にはデータの有用性が制限されます。しかしながら、現存するヘルスエコシステムは高度に分断化しており、一般的に計算可能な形式でデータを定義、収集、交換する準備が整っていません。できる限り、実装者および/または仕様ライターはこの要素の使用を避けるべきです。使用する場合、URLは、そのナラティブとともに他のプロファイル、値セットなどを含む実装ガイドを定義する参照となります。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Resource.implicitRules"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="uri"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="true"/>
      <isModifierReason value="This element is labeled as a modifier because the implicit rules may provide additional knowledge about the resource that modifies it's meaning or interpretation"/>
      <isSummary value="true"/>
    </element>
    <element id="Media.language">
      <path value="Media.language"/>
      <short value="「リソースコンテンツの言語」(Risōsukontentsu no gengo)"/>
      <definition value="「リソースが書かれている基本言語。」"/>
      <comment value="言語はインデックスとアクセシビリティをサポートするために提供されます（通常、テキスト読み上げなどのサービスは言語タグを使用します）。物語のHTML言語タグは、物語に適用されます。リソース上の言語タグは、リソース内のデータから生成される他のプレゼンテーションの言語を指定するために使用できます。すべてのコンテンツが基本言語である必要はありません。Resource.languageは自動的に物語に適用されたと想定してはいけません。言語が指定されている場合、HTMLのdiv要素にも指定する必要があります（xml：langとhtml lang属性の関係に関する情報はHTML5の規則を参照）。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Resource.language"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="code"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="false"/>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueSet">
          <valueCanonical value="http://hl7.org/fhir/ValueSet/all-languages"/>
        </extension>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="Language"/>
        </extension>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-isCommonBinding">
          <valueBoolean value="true"/>
        </extension>
        <strength value="preferred"/>
        <description value="「人間の言語。」(Ningen no gengo.)"/>
        <valueSet value="http://hl7.org/fhir/ValueSet/languages"/>
      </binding>
    </element>
    <element id="Media.text">
      <path value="Media.text"/>
      <short value="「人間の解釈のためのリソースのテキスト要約」"/>
      <definition value="「リソースの要約を含む人が読めるナビゲーションであり、リソースの内容を人に表現するために使用できます。ナビゲーションはすべての構造化されたデータをエンコードする必要はありませんが、人間がナビゲーションを読むだけで「臨床的に安全」であるために十分な詳細を含む必要があります。リソース定義には、臨床的な安全性を確保するためにナビゲーションで表現する必要があるコンテンツが定義される場合があります。」"/>
      <comment value="含まれるリソースには説明がありません。含まれないリソースには説明が必要です。場合によっては、リソースが少量のデータしか含まず、テキストだけで表現されることがあります（minOccurs = 1要素がすべて満たされている限り）。これは、情報が「テキストの塊」としてキャプチャされるレガシーシステムからのデータや、テキストが生またはナレーションされて符号化された情報が後で追加される場合に必要な場合があります。"/>
      <alias value="narrative"/>
      <alias value="html"/>
      <alias value="xhtml"/>
      <alias value="display"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="DomainResource.text"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="Narrative"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="false"/>
      <mapping>
        <identity value="rim"/>
        <map value="Act.text?"/>
      </mapping>
    </element>
    <element id="Media.contained">
      <path value="Media.contained"/>
      <short value="「含まれている、インラインのリソース」(Fukuma rete iru, inrain no risōsu)"/>
      <definition value="「これらのリソースは、それらを含むリソースから独立した存在を持ちません。それらは独立して識別することはできず、独自の独立したトランザクション範囲を持つこともできません。」"/>
      <comment value="「コンテンツが適切に識別できる場合には、これを行うべきではありません。識別が失われると、再び復元することは非常に困難であり（文脈に依存します）、メタ要素にプロファイルとタグを持つことができますが、セキュリティのラベルを持っていてはいけません。」"/>
      <alias value="inline resources"/>
      <alias value="anonymous resources"/>
      <alias value="contained resources"/>
      <min value="0"/>
      <max value="*"/>
      <base>
        <path value="DomainResource.contained"/>
        <min value="0"/>
        <max value="*"/>
      </base>
      <type>
        <code value="Resource"/>
      </type>
      <isModifier value="false"/>
      <isSummary value="false"/>
      <mapping>
        <identity value="rim"/>
        <map value="N/A"/>
      </mapping>
    </element>
    <element id="Media.extension">
      <path value="Media.extension"/>
      <short value="実装によって定義される追加コンテンツ"/>
      <definition value="「リソースの基本的な定義の一部ではない追加情報を表すために使用することができます。拡張機能の使用を安全かつ管理可能にするために、定義と使用の一定のガバナンスが適用されます。実装者はどんな拡張機能でも定義できますが、拡張機能の定義の一部として満たす必要がある要件があります」"/>
      <comment value="どのようなアプリケーション、プロジェクト、または標準が拡張機能を使用しているかに関わらず、拡張機能の使用には決して汚名が付くわけではありません - それらを使用または定義する機関または管轄区域に関係なく。拡張機能の使用こそが、FHIR仕様を誰にとっても簡単なコアレベルで維持することを可能にします。"/>
      <alias value="extensions"/>
      <alias value="user content"/>
      <min value="0"/>
      <max value="*"/>
      <base>
        <path value="DomainResource.extension"/>
        <min value="0"/>
        <max value="*"/>
      </base>
      <type>
        <code value="Extension"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <constraint>
        <key value="ext-1"/>
        <severity value="error"/>
        <human value="「拡張機能または値[x]のいずれかが必要です。両方ではありません。」"/>
        <expression value="extension.exists() != value.exists()"/>
        <xpath value="exists(f:extension)!=exists(f:*[starts-with(local-name(.), &quot;value&quot;)])"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Extension"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="false"/>
      <mapping>
        <identity value="rim"/>
        <map value="N/A"/>
      </mapping>
    </element>
    <element id="Media.modifierExtension">
      <path value="Media.modifierExtension"/>
      <short value="無視できない拡張機能 (Mushi dekinai kakuchou kinou)"/>
      <definition value="「リソースの基本的な定義に含まれない、要素の理解や、それを含む要素の子孫の理解を修正する追加情報を表すためにも使用されることがあります。通常、修飾要素は否定や修飾を提供します。拡張機能の使用を安全で管理しやすくするために、拡張機能の定義と使用に対して厳格な統治が適用されます。実装者は拡張機能を定義することが許可されていますが、拡張機能の定義の一部として満たす必要がある要件があります。リソースを処理するアプリケーションは、修飾子拡張をチェックする必要があります。修飾子拡張は、リソースまたはドメインリソースの任意の要素の意味を変更してはなりません（修飾子拡張自体の意味も変更できません）。」"/>
      <comment value="どのようなアプリケーション、プロジェクト、または標準が拡張機能を使用しているかに関わらず、拡張機能の使用には決して汚名が付くわけではありません - それらを使用または定義する機関または管轄区域に関係なく。拡張機能の使用こそが、FHIR仕様を誰にとっても簡単なコアレベルで維持することを可能にします。"/>
      <requirements value="Modifier extensions allow for extensions that *cannot* be safely ignored to be clearly distinguished from the vast majority of extensions which can be safely ignored.  This promotes interoperability by eliminating the need for implementers to prohibit the presence of extensions. For further information, see the [definition of modifier extensions](http://hl7.org/fhir/R4/extensibility.html#modifierExtension)."/>
      <alias value="extensions"/>
      <alias value="user content"/>
      <min value="0"/>
      <max value="*"/>
      <base>
        <path value="DomainResource.modifierExtension"/>
        <min value="0"/>
        <max value="*"/>
      </base>
      <type>
        <code value="Extension"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <constraint>
        <key value="ext-1"/>
        <severity value="error"/>
        <human value="「拡張機能または値[x]のいずれかが必要です。両方ではありません。」"/>
        <expression value="extension.exists() != value.exists()"/>
        <xpath value="exists(f:extension)!=exists(f:*[starts-with(local-name(.), &quot;value&quot;)])"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Extension"/>
      </constraint>
      <isModifier value="true"/>
      <isModifierReason value="Modifier extensions are expected to modify the meaning or interpretation of the resource that contains them"/>
      <isSummary value="false"/>
      <mapping>
        <identity value="rim"/>
        <map value="N/A"/>
      </mapping>
    </element>
    <element id="Media.identifier">
      <path value="Media.identifier"/>
      <short value="製品またはシステムが管理する、施設内で画像（JPEG等）、映像（MPEG等）、音声ファイルなどのメディアを一意に識別するためのID。"/>
      <definition value="製品またはシステムが管理する、施設内で画像（JPEG等）、映像（MPEG等）、音声ファイルなどのメディアを一意に識別するためのID。"/>
      <comment value="&quot;識別子のラベルと使用法によって、どの種類の識別子であるかを判断することができます。&quot;"/>
      <min value="0"/>
      <max value="*"/>
      <base>
        <path value="Media.identifier"/>
        <min value="0"/>
        <max value="*"/>
      </base>
      <type>
        <code value="Identifier"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <mustSupport value="true"/>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.identifier"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.identifier"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".id"/>
      </mapping>
      <mapping>
        <identity value="dicom"/>
        <map value="0008,0018 | ~0008,0050 | 0020,000D | 0020,000E"/>
      </mapping>
    </element>
    <element id="Media.basedOn">
      <path value="Media.basedOn"/>
      <short value="他のシステムから依頼されたオーダ情報。"/>
      <definition value="他のシステムから依頼されたオーダ情報。"/>
      <comment value="通常、依頼元となるServiceRequestリソースを参照する。他のシステムと連携していない場合は参照不要。"/>
      <requirements value="Allows tracing of authorization for the event and tracking whether proposals/recommendations were acted upon."/>
      <alias value="fulfills"/>
      <min value="0"/>
      <max value="*"/>
      <base>
        <path value="Media.basedOn"/>
        <min value="0"/>
        <max value="*"/>
      </base>
      <type>
        <code value="Reference"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/ServiceRequest"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/CarePlan"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.basedOn"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".outboundRelationship[typeCode=FLFS].target"/>
      </mapping>
    </element>
    <element id="Media.partOf">
      <path value="Media.partOf"/>
      <short value="参照されるイベントの一部。"/>
      <definition value="参照されるイベントの一部。"/>
      <comment value="使用する場合は、基底にある Definition、Requirement、Comments の内容を参考に使用する。"/>
      <requirements value="E.g. Drug administration as part of a procedure, procedure as part of observation, etc."/>
      <alias value="container"/>
      <min value="0"/>
      <max value="*"/>
      <base>
        <path value="Media.partOf"/>
        <min value="0"/>
        <max value="*"/>
      </base>
      <type>
        <code value="Reference"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Resource"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.partOf"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".inboundRelationship[typeCode=COMP].source[moodCode=EVN]"/>
      </mapping>
    </element>
    <element id="Media.status">
      <path value="Media.status"/>
      <short value="メディアのステータス。"/>
      <definition value="メディアのステータス。"/>
      <comment value="”completed” を指定する。"/>
      <min value="1"/>
      <max value="1"/>
      <base>
        <path value="Media.status"/>
        <min value="1"/>
        <max value="1"/>
      </base>
      <type>
        <code value="code"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="true"/>
      <isModifierReason value="This element is labelled as a modifier because it is a status element that contains status entered-in-error which means that the resource should not be treated as valid"/>
      <isSummary value="true"/>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="MediaStatus"/>
        </extension>
        <strength value="required"/>
        <description value="&quot;イベントのライフサイクルの段階を識別するコード。&quot;"/>
        <valueSet value="http://hl7.org/fhir/ValueSet/event-status|4.0.1"/>
      </binding>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.status"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.status"/>
      </mapping>
      <mapping>
        <identity value="v2"/>
        <map value="Varies by domain"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".status"/>
      </mapping>
    </element>
    <element id="Media.type">
      <path value="Media.type"/>
      <short value="メディアの種類。"/>
      <definition value="メディアの種類。"/>
      <comment value="使用する場合は、メディアの種類を image, video, audio から選択する。"/>
      <requirements value="Used for filtering what observations are retrieved and displayed."/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.type"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="MediaType"/>
        </extension>
        <strength value="extensible"/>
        <description value="高水準メディアカテゴリのコード。"/>
        <valueSet value="http://hl7.org/fhir/ValueSet/media-type"/>
      </binding>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.class"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".code"/>
      </mapping>
    </element>
    <element id="Media.modality">
      <path value="Media.modality"/>
      <short value="メディアを取得・撮影した装置（モダリティ）。"/>
      <definition value="メディアを取得・撮影した装置（モダリティ）。"/>
      <comment value="使用する場合、ImagingStudy同様”ES”を指定する。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.modality"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="MediaModality"/>
        </extension>
        <strength value="example"/>
        <description value="「画像の種類に関する詳細情報-種類、目的、または生成に使用される機器の種類についての情報。」"/>
        <valueSet value="http://hl7.org/fhir/ValueSet/media-modality"/>
      </binding>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.code"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.what[x]"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".outboundRelationship[typeCode=&quot;COMP].target[classCode=&quot;LIST&quot;, moodCode=&quot;EVN&quot;].code"/>
      </mapping>
      <mapping>
        <identity value="dicom"/>
        <map value="0008,0060 | 0008,1032"/>
      </mapping>
    </element>
    <element id="Media.view">
      <path value="Media.view"/>
      <short value="メディアのイメージングビュー（例：横方向、前後方向など）。"/>
      <definition value="メディアのイメージングビュー（例：横方向、前後方向など）。"/>
      <comment value="内視鏡では省略してよい。将来的にニーズが出てきた場合には検討する。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.view"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="MediaView"/>
        </extension>
        <strength value="example"/>
        <description value="画像を収集する際に使用される投影イメージングビュー。"/>
        <valueSet value="http://hl7.org/fhir/ValueSet/media-view"/>
      </binding>
      <mapping>
        <identity value="rim"/>
        <map value="DiagnosticImage.subjectOrientationCode"/>
      </mapping>
    </element>
    <element id="Media.subject">
      <path value="Media.subject"/>
      <short value="メディアの対象患者に関する情報。"/>
      <definition value="メディアの対象患者に関する情報。"/>
      <comment value="JP Core Patientリソースを参照する。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.subject"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="Reference"/>
        <targetProfile value="http://jpfhir.jp/fhir/core/StructureDefinition/JP_Patient"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <mustSupport value="true"/>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.subject"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.subject[x]"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".participation[typeCode=&quot;SUBJ&quot;]???"/>
      </mapping>
      <mapping>
        <identity value="dicom"/>
        <map value="~0010,0020"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.subject"/>
      </mapping>
    </element>
    <element id="Media.encounter">
      <path value="Media.encounter"/>
      <short value="このメディアが生成されるきっかけとなった情報。"/>
      <definition value="このメディアが生成されるきっかけとなった情報。"/>
      <comment value="JP Core Encounterリソースを参照する。"/>
      <requirements value="Links the Media to the Encounter context."/>
      <alias value="context"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.encounter"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="Reference"/>
        <targetProfile value="http://jpfhir.jp/fhir/core/StructureDefinition/JP_Encounter"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.encounter"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.context"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".inboundRelationship(typeCode=COMP].source[classCode&lt;=PCPR, moodCode=EVN]"/>
      </mapping>
    </element>
    <element id="Media.created[x]">
      <path value="Media.created[x]"/>
      <short value="このメディアが生成された日時。"/>
      <definition value="このメディアが生成された日時。"/>
      <comment value="静止画の場合createdDateTime、ビデオ、音声の場合createdPeriodを指定する。"/>
      <alias value="timing"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.created[x]"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="dateTime"/>
      </type>
      <type>
        <code value="Period"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.occurrence[x]"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.done[x]"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".effectiveTime"/>
      </mapping>
    </element>
    <element id="Media.issued">
      <path value="Media.issued"/>
      <short value="DiagnosticReportのStatusがFinalになった日時（レポート確定日時）。"/>
      <definition value="DiagnosticReportのStatusがFinalになった日時（レポート確定日時）。"/>
      <comment value="内視鏡では、mediaが示すデータが単独でリソース化されることはない前提。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.issued"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="instant"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.recorded"/>
      </mapping>
      <mapping>
        <identity value="v2"/>
        <map value="OBR.22 (or MSH.7), or perhaps OBX-19 (depends on who observation made)"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value="participation[typeCode=AUT].time"/>
      </mapping>
    </element>
    <element id="Media.operator">
      <path value="Media.operator"/>
      <short value="内視鏡検査の実施医。"/>
      <definition value="内視鏡検査の実施医。"/>
      <comment value="内視鏡検査実施医の情報が入っているリソースを参照する。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.operator"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="Reference"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Practitioner"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/PractitionerRole"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Organization"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/CareTeam"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Patient"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Device"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/RelatedPerson"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.performer.actor"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.actor"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".participation[typeCode=&quot;PERF&quot;]???"/>
      </mapping>
      <mapping>
        <identity value="dicom"/>
        <map value="0008,1060?"/>
      </mapping>
    </element>
    <element id="Media.reasonCode">
      <path value="Media.reasonCode"/>
      <short value="このメディアが生成された理由。"/>
      <definition value="このメディアが生成された理由。"/>
      <comment value="内視鏡では省略してよい。"/>
      <min value="0"/>
      <max value="*"/>
      <base>
        <path value="Media.reasonCode"/>
        <min value="0"/>
        <max value="*"/>
      </base>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="MediaReason"/>
        </extension>
        <strength value="example"/>
        <description value="メディアの理由。"/>
        <valueSet value="http://hl7.org/fhir/ValueSet/procedure-reason"/>
      </binding>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.reasonCode"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.why[x]"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".reasonCode"/>
      </mapping>
    </element>
    <element id="Media.bodySite">
      <path value="Media.bodySite"/>
      <short value="このメディアの対象となる解剖学的部位。"/>
      <definition value="このメディアの対象となる解剖学的部位。"/>
      <comment value="内視鏡では省略してよい。将来的にニーズが出てきた場合には検討する。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.bodySite"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="BodySite"/>
        </extension>
        <strength value="example"/>
        <description value="解剖学的位置を記述するコード。左右対称性を含む場合があります。"/>
        <valueSet value="http://hl7.org/fhir/ValueSet/body-site"/>
      </binding>
      <mapping>
        <identity value="sct-concept"/>
        <map value="&lt; 123037004 |Body structure|"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value="targetSiteCode"/>
      </mapping>
      <mapping>
        <identity value="sct-attr"/>
        <map value="718497002 |Inherent location|"/>
      </mapping>
    </element>
    <element id="Media.deviceName">
      <path value="Media.deviceName"/>
      <short value="このメディアを生成した装置名。"/>
      <definition value="このメディアを生成した装置名。"/>
      <comment value="原則機種名（スコープ）を記載する。デジカメの場合Exifヘッダの機種名とする。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.deviceName"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="string"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="rim"/>
        <map value=".participation[typeCode=&quot;DEV&quot;].role.player.Entity[classCode=&quot;DEV&quot;].name"/>
      </mapping>
      <mapping>
        <identity value="dicom"/>
        <map value="0008,0070"/>
      </mapping>
    </element>
    <element id="Media.device">
      <path value="Media.device"/>
      <short value="メディアの収集に使用されるデバイス。"/>
      <definition value="メディアの収集に使用されるデバイス。"/>
      <comment value="内視鏡では省略してよい。使用する場合には、参照するリソースで定義して使用する。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.device"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="Reference"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Device"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/DeviceMetric"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Device"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="sct-concept"/>
        <map value="&lt; 49062001 |Device|"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value="participation[typeCode=DEV]"/>
      </mapping>
      <mapping>
        <identity value="sct-attr"/>
        <map value="424226004 |Using device|"/>
      </mapping>
    </element>
    <element id="Media.height">
      <path value="Media.height"/>
      <short value="画像の高さ（ピクセル単位）（写真/ビデオ）。"/>
      <definition value="画像の高さ（ピクセル単位）（写真/ビデオ）。"/>
      <comment value="使用する場合は、画像の高さ（ピクセル単位）（写真/ビデオ）を指定する。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.height"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="positiveInt"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="rim"/>
        <map value=".outboundRelationship[typeCode=&quot;COMP].target[classCode=&quot;OBS&quot;, moodCode=&quot;EVN&quot;,code=&quot;&lt;CODE&gt;&quot;].value"/>
      </mapping>
      <mapping>
        <identity value="dicom"/>
        <map value="0028,0010"/>
      </mapping>
    </element>
    <element id="Media.width">
      <path value="Media.width"/>
      <short value="画像の幅（ピクセル単位）（写真/ビデオ）。"/>
      <definition value="画像の幅（ピクセル単位）（写真/ビデオ）。"/>
      <comment value="使用する場合は、画像の幅（ピクセル単位）（写真/ビデオ）を指定する。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.width"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="positiveInt"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="rim"/>
        <map value=".outboundRelationship[typeCode=&quot;COMP].target[classCode=&quot;OBS&quot;, moodCode=&quot;EVN&quot;,code=&quot;&lt;CODE&gt;&quot;].value"/>
      </mapping>
      <mapping>
        <identity value="dicom"/>
        <map value="0028,0011"/>
      </mapping>
    </element>
    <element id="Media.frames">
      <path value="Media.frames"/>
      <short value="フレーム数。"/>
      <definition value="フレーム数。"/>
      <comment value="EUSの場合など、フレーム数が1より大きいメディア（単一のメディアで複数のスライスを取得する画像取得コンテキスト）を扱う場合に使用する。"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.frames"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="positiveInt"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="rim"/>
        <map value=".outboundRelationship[typeCode=&quot;COMP].target[classCode=&quot;OBS&quot;, moodCode=&quot;EVN&quot;,code=&quot;&lt;CODE&gt;&quot;].value"/>
      </mapping>
    </element>
    <element id="Media.duration">
      <path value="Media.duration"/>
      <short value="ビデオ映像・音声向けの、秒単位の録画・記録時間。"/>
      <definition value="ビデオ映像・音声向けの、秒単位の録画・記録時間。"/>
      <comment value="「録画が一時停止した場合、期間が発生期間と異なる場合があります。」"/>
      <min value="0"/>
      <max value="1"/>
      <base>
        <path value="Media.duration"/>
        <min value="0"/>
        <max value="1"/>
      </base>
      <type>
        <code value="decimal"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="rim"/>
        <map value=".outboundRelationship[typeCode=&quot;COMP].target[classCode=&quot;OBS&quot;, moodCode=&quot;EVN&quot;,code=&quot;&lt;CODE&gt;&quot;].value"/>
      </mapping>
      <mapping>
        <identity value="dicom"/>
        <map value="~0028,0002"/>
      </mapping>
    </element>
    <element id="Media.content">
      <path value="Media.content"/>
      <short value="埋め込まれたメディアの実際のコンテンツ、またはメディアソースファイルへの直接参照。"/>
      <definition value="埋め込まれたメディアの実際のコンテンツ、またはメディアソースファイルへの直接参照。"/>
      <comment value="推奨コンテンツタイプ：image/jpeg、image/png、image/tiff、video/mpeg、audio/mp4、application/dicom。application/dicomには転送構文をパラメータとして含めることができます。時間をカバーするメディア（動画/音声）の場合、content.creationTimeは終了時間です。作成時間は追跡、バージョンの整理および検索に使用されます。"/>
      <min value="1"/>
      <max value="1"/>
      <base>
        <path value="Media.content"/>
        <min value="1"/>
        <max value="1"/>
      </base>
      <type>
        <code value="Attachment"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="true"/>
      <mapping>
        <identity value="rim"/>
        <map value=".text"/>
      </mapping>
    </element>
    <element id="Media.note">
      <path value="Media.note"/>
      <short value="メディアについてのコメント。"/>
      <definition value="メディアについてのコメント。"/>
      <comment value="「観察、結論などに使用しないでください。代わりに、Media/ImagingStudyリソースに基づく[観察]を使用してください。」"/>
      <min value="0"/>
      <max value="*"/>
      <base>
        <path value="Media.note"/>
        <min value="0"/>
        <max value="*"/>
      </base>
      <type>
        <code value="Annotation"/>
      </type>
      <constraint>
        <key value="ele-1"/>
        <severity value="error"/>
        <human value="すべてのFHIR要素は、@valueまたはchildrenを持っている必要があります。"/>
        <expression value="hasValue() or (children().count() &gt; id.count())"/>
        <xpath value="@value|f:*|h:div"/>
        <source value="http://hl7.org/fhir/StructureDefinition/Element"/>
      </constraint>
      <isModifier value="false"/>
      <isSummary value="false"/>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.note"/>
      </mapping>
      <mapping>
        <identity value="v2"/>
        <map value="NTE"/>
      </mapping>
      <mapping>
        <identity value="rim"/>
        <map value=".inboundRelationship(typeCode=SUBJ].source[classCode=ANNGEN, moodCode=EVN].value[xsi:type=ST]"/>
      </mapping>
    </element>
  </snapshot>
  <differential>
    <element id="Media">
      <path value="Media"/>
      <short value="内視鏡検査で取得または使用される画像、映像、音声に関わる情報。"/>
      <definition value="内視鏡検査で取得または使用される画像、映像、音声に関わる情報。"/>
    </element>
    <element id="Media.identifier">
      <path value="Media.identifier"/>
      <short value="製品またはシステムが管理する、施設内で画像（JPEG等）、映像（MPEG等）、音声ファイルなどのメディアを一意に識別するためのID。"/>
      <definition value="製品またはシステムが管理する、施設内で画像（JPEG等）、映像（MPEG等）、音声ファイルなどのメディアを一意に識別するためのID。"/>
      <mustSupport value="true"/>
    </element>
    <element id="Media.basedOn">
      <path value="Media.basedOn"/>
      <short value="他のシステムから依頼されたオーダ情報。"/>
      <definition value="他のシステムから依頼されたオーダ情報。"/>
      <comment value="通常、依頼元となるServiceRequestリソースを参照する。他のシステムと連携していない場合は参照不要。"/>
    </element>
    <element id="Media.partOf">
      <path value="Media.partOf"/>
      <short value="参照されるイベントの一部。"/>
      <definition value="参照されるイベントの一部。"/>
      <comment value="使用する場合は、基底にある Definition、Requirement、Comments の内容を参考に使用する。"/>
    </element>
    <element id="Media.status">
      <path value="Media.status"/>
      <short value="メディアのステータス。"/>
      <definition value="メディアのステータス。"/>
      <comment value="”completed” を指定する。"/>
    </element>
    <element id="Media.type">
      <path value="Media.type"/>
      <short value="メディアの種類。"/>
      <definition value="メディアの種類。"/>
      <comment value="使用する場合は、メディアの種類を image, video, audio から選択する。"/>
    </element>
    <element id="Media.modality">
      <path value="Media.modality"/>
      <short value="メディアを取得・撮影した装置（モダリティ）。"/>
      <definition value="メディアを取得・撮影した装置（モダリティ）。"/>
      <comment value="使用する場合、ImagingStudy同様”ES”を指定する。"/>
    </element>
    <element id="Media.view">
      <path value="Media.view"/>
      <short value="メディアのイメージングビュー（例：横方向、前後方向など）。"/>
      <definition value="メディアのイメージングビュー（例：横方向、前後方向など）。"/>
      <comment value="内視鏡では省略してよい。将来的にニーズが出てきた場合には検討する。"/>
    </element>
    <element id="Media.subject">
      <path value="Media.subject"/>
      <short value="メディアの対象患者に関する情報。"/>
      <definition value="メディアの対象患者に関する情報。"/>
      <comment value="JP Core Patientリソースを参照する。"/>
      <type>
        <code value="Reference"/>
        <targetProfile value="http://jpfhir.jp/fhir/core/StructureDefinition/JP_Patient"/>
      </type>
      <mustSupport value="true"/>
    </element>
    <element id="Media.encounter">
      <path value="Media.encounter"/>
      <short value="このメディアが生成されるきっかけとなった情報。"/>
      <definition value="このメディアが生成されるきっかけとなった情報。"/>
      <comment value="JP Core Encounterリソースを参照する。"/>
      <type>
        <code value="Reference"/>
        <targetProfile value="http://jpfhir.jp/fhir/core/StructureDefinition/JP_Encounter"/>
      </type>
    </element>
    <element id="Media.created[x]">
      <path value="Media.created[x]"/>
      <short value="このメディアが生成された日時。"/>
      <definition value="このメディアが生成された日時。"/>
      <comment value="静止画の場合createdDateTime、ビデオ、音声の場合createdPeriodを指定する。"/>
    </element>
    <element id="Media.issued">
      <path value="Media.issued"/>
      <short value="DiagnosticReportのStatusがFinalになった日時（レポート確定日時）。"/>
      <definition value="DiagnosticReportのStatusがFinalになった日時（レポート確定日時）。"/>
      <comment value="内視鏡では、mediaが示すデータが単独でリソース化されることはない前提。"/>
    </element>
    <element id="Media.operator">
      <path value="Media.operator"/>
      <short value="内視鏡検査の実施医。"/>
      <definition value="内視鏡検査の実施医。"/>
      <comment value="内視鏡検査実施医の情報が入っているリソースを参照する。"/>
    </element>
    <element id="Media.reasonCode">
      <path value="Media.reasonCode"/>
      <short value="このメディアが生成された理由。"/>
      <definition value="このメディアが生成された理由。"/>
      <comment value="内視鏡では省略してよい。"/>
    </element>
    <element id="Media.bodySite">
      <path value="Media.bodySite"/>
      <short value="このメディアの対象となる解剖学的部位。"/>
      <definition value="このメディアの対象となる解剖学的部位。"/>
      <comment value="内視鏡では省略してよい。将来的にニーズが出てきた場合には検討する。"/>
    </element>
    <element id="Media.deviceName">
      <path value="Media.deviceName"/>
      <short value="このメディアを生成した装置名。"/>
      <definition value="このメディアを生成した装置名。"/>
      <comment value="原則機種名（スコープ）を記載する。デジカメの場合Exifヘッダの機種名とする。"/>
    </element>
    <element id="Media.device">
      <path value="Media.device"/>
      <short value="メディアの収集に使用されるデバイス。"/>
      <definition value="メディアの収集に使用されるデバイス。"/>
      <comment value="内視鏡では省略してよい。使用する場合には、参照するリソースで定義して使用する。"/>
    </element>
    <element id="Media.height">
      <path value="Media.height"/>
      <short value="画像の高さ（ピクセル単位）（写真/ビデオ）。"/>
      <definition value="画像の高さ（ピクセル単位）（写真/ビデオ）。"/>
      <comment value="使用する場合は、画像の高さ（ピクセル単位）（写真/ビデオ）を指定する。"/>
    </element>
    <element id="Media.width">
      <path value="Media.width"/>
      <short value="画像の幅（ピクセル単位）（写真/ビデオ）。"/>
      <definition value="画像の幅（ピクセル単位）（写真/ビデオ）。"/>
      <comment value="使用する場合は、画像の幅（ピクセル単位）（写真/ビデオ）を指定する。"/>
    </element>
    <element id="Media.frames">
      <path value="Media.frames"/>
      <short value="フレーム数。"/>
      <definition value="フレーム数。"/>
      <comment value="EUSの場合など、フレーム数が1より大きいメディア（単一のメディアで複数のスライスを取得する画像取得コンテキスト）を扱う場合に使用する。"/>
    </element>
    <element id="Media.duration">
      <path value="Media.duration"/>
      <short value="ビデオ映像・音声向けの、秒単位の録画・記録時間。"/>
      <definition value="ビデオ映像・音声向けの、秒単位の録画・記録時間。"/>
    </element>
    <element id="Media.content">
      <path value="Media.content"/>
      <short value="埋め込まれたメディアの実際のコンテンツ、またはメディアソースファイルへの直接参照。"/>
      <definition value="埋め込まれたメディアの実際のコンテンツ、またはメディアソースファイルへの直接参照。"/>
    </element>
    <element id="Media.note">
      <path value="Media.note"/>
      <short value="メディアについてのコメント。"/>
      <definition value="メディアについてのコメント。"/>
    </element>
  </differential>
</StructureDefinition>